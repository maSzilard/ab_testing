!function(){"use strict";const t=function(t){let e=parseFloat(t);return e%1==0?e.toFixed(2):e.toString().includes(".")?e.toString().padEnd(e.toString().indexOf(".")+3,"0"):e.toFixed(2)},e={waitForSwiper:function(t){let o=setTimeout(function(){"function"!=typeof window.Swiper?e.waitForSwiper(t):(clearTimeout(o),t())},100)},addSwiper:function(){void 0!==window.jQuery&&"function"!=typeof window.Swiper&&(jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"}).appendTo("head"),jQuery("<script/>",{type:"text/javascript",src:"https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"}).appendTo("head"))}};e.addSwiper();const o=function(o){jQuery.ajax({url:"/wp-json/custom/v1/cross-sells/"+o,type:"GET",success:function(o){if(console.log(o),o.length>0){jQuery(".ATC-popup__product_cross_sells").html(""),jQuery(".ATC-popup").addClass("hasCrossSells");var r="";r+='<button class="ATC_carousel-btn ATC_carousel-prev">&#10094;</button>',r+='<button class="ATC_carousel-btn ATC_carousel-next">&#10095;</button>',r+='<h3 class="ATC-popup__product_cross_sells--h3">You might also be interested in:</h3>',r+='<div class="ATC-popup__product_cross_sells--container swiper-wrapper">',jQuery(o).each(function(e,o){r+='<div class="ATC-popup__product_cross_sell swiper-slide">',r+='<div class="ATC-popup__product_cross_sell__inner">',r+='<a href="'+o.url+'">',r+='<img class="ATC-popup__product_cross_sell--image" src="'+o.image+'" />',r+='<h3 class="ATC-popup__product_cross_sell--title">'+o.title+"</h3>",r+='<div class="ATC-popup__product_cross_sell--prices">',o.sale_price&&o.sale_price>0&&(r+='<div class="ATC-popup__product_cross_sell--price-old">'+o.currency_symbol+t(o.sale_price)+" <span>"+o.vat+"</span></div>"),r+='<div class="ATC-popup__product_cross_sell--price">'+o.currency_symbol+t(o.regular_price)+" <span>"+o.vat+"</span></div>",r+="</div>",r+="</a>",r+='<div class="ATC-popup__product_cross_sell--cart">',r+='<input type="number" class="input-text qty text" step="1" min="1" max="999" name="quantity" value="1" title="Qty" size="4" pattern="[0-9]*" inputmode="numeric">',r+='<a href="/?add-to-cart='+o.id+'" data-quantity="1" class="button product_type_simple add_to_cart_button ajax_add_to_cart addToCartCrossSell" data-product_id="'+o.id+'" data-product_sku="" data-product-title="'+o.title+'" aria-label="Add &quot;'+o.title+'&quot; to your basket" rel="nofollow"><i class="fa fa-shopping-cart"></i>ADD TO CART</a>',r+="</div>",r+="</div>",r+="</div>"}),r+="</div>",jQuery(".ATC-popup__product_cross_sells").html(r),jQuery(".ATC-popup__product_cross_sell--cart input").on("keyup change",function(){var t=jQuery(this).val();console.log(t),jQuery(this).closest(".ATC-popup__product_cross_sell--cart").find("a.add_to_cart_button").attr("data-quantity",t)}),e.waitForSwiper(function(){new Swiper(".ATC-swiper",{slidesPerView:4,spaceBetween:5,loop:!1,navigation:{nextEl:".ATC_carousel-btn.ATC_carousel-next",prevEl:".ATC_carousel-btn.ATC_carousel-prev"},breakpoints:{320:{slidesPerView:1.2,spaceBetween:5},480:{slidesPerView:1.5,spaceBetween:5},840:{slidesPerView:2.5,spaceBetween:5},1400:{slidesPerView:4,spaceBetween:5}}})})}}})};!function t(e,o){document.querySelector(e)?o():setTimeout(()=>t(e,o),100)}(".which-mesh-category tbody tr.table_string",function(){if(!(window.innerWidth<=1024))return;const t=function(){const t=document.querySelectorAll(".which-mesh-category thead th"),e=[],o=[],r={};return t.forEach((t,s)=>{let a=t.textContent.trim(),i=a.toLowerCase().replace(/\s*\(.*?\)/g,"").replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_");a.toLowerCase().includes("coating")&&(i="coating"),(a.toLowerCase().includes("hole size")||a.toLowerCase().includes("aperture"))&&(i="holeSize"),a.toLowerCase().includes("depth")&&(i="depth"),a.toLowerCase().includes("height")&&(i="height"),a.toLowerCase().includes("length")&&(i="length"),(a.toLowerCase().includes("wire diameter")||a.toLowerCase().includes("gauge"))&&(i="wireDiameter"),a.toLowerCase().includes("quantity")&&(i="quantity"),a.toLowerCase().includes("price")&&(i="price"),["quantity","price","name","image","add to cart","product"].some(t=>a.toLowerCase().includes(t))||["quantity","price","name","image","add_to_cart","product"].some(t=>i.includes(t))||(e.push(i),o.push(a),r[i]=s)}),{columns:e,headers:o,cellIndexMap:r}}();console.log("Detected product category:",t),console.log("Column config:",t);const e=document.createElement("style");function r(e){return e&&0!==e.length?e.map(e=>{const o=e.video.hasVideo?'<div class="video-wrapper" data-video-id="'+e.video.id+'"> <i class="fa fa-play-circle" aria-hidden="true"></i> <span class="title">Show video</span> </div>':'<div class="video-wrapper" style="visibility: hidden;"></div>',r=t.columns.map((o,r)=>'<div class="spec-row"><span>'+("wireDiameter"===o?"Wire Dia":t.headers[r])+":</span><span>"+(e.attributes[o]||"")+"</span></div>").join(""),s=t.columns.map(t=>"data-"+t.toLowerCase().replace(/([A-Z])/g,"-$1")+'="'+(e.attributes[t]||"")+'"').join(" ");return'<div class="product-card" data-product-id="'+e.id+'" '+s+'><div class="card-top"><div class="product-image"><a href="'+e.url+'"><img src="'+e.image.url+'" alt="'+e.image.alt+'"></a></div><div class="product-details"><div class="product-name"><a href="'+e.url+'">'+e.name+'</a></div><div class="product-specs">'+r+'</div></div></div><div class="card-middle">'+o+'<div class="price-section"><div class="price">£'+e.price+'</div><div class="price-label">inc. VAT</div></div></div><div class="card-bottom"><div class="quantity-section"><div class="quantity-controls"><button class="qty-btn qty-minus" data-product-id="'+e.id+'">-</button><input type="number" class="quantity-input" value="'+e.quantity+'" min="1" data-product-id="'+e.id+'" readonly><button class="qty-btn qty-plus" data-product-id="'+e.id+'">+</button></div></div><button class="add-to-cart-btn add_to_cart_button" data-product-id="'+e.id+'" data-product-name="'+e.name+'">Add to cart</button></div></div>'}).join(""):'<div class="no-products">No results, please try again by trying a new filter combination.</div>'}function s(){const e=function(){const e=[],o=document.querySelectorAll(".which-mesh-category tbody tr.table_string");return console.log("Found table rows:",o.length),o.forEach(o=>{const r=o.querySelector(".product-image-td img"),s=r?r.src:"https://www.wirefence.co.uk/wp-content/uploads/woocommerce-placeholder.png",a=r?r.alt:"",i=o.querySelector(".product-image-td a"),n=i?i.href:"",c=o.querySelector(".video-wrapper"),l=c?c.getAttribute("data-video-id"):"",d={};let u="1",p="",h="",y="";h=o.getAttribute("data-product-id")||"",y=o.getAttribute("data-name")||"",p=o.getAttribute("data-price")||"";const m=o.querySelectorAll("td");t.columns.forEach((e,o)=>{const r=t.cellIndexMap[e];if(m[r]){const t=m[r],o=t.textContent.trim(),s=t.querySelector("a"),a=s?s.textContent.trim():o;d[e]=a}});const v=t.columns.length+1,f=t.columns.length+2;if(m[v]){const t=m[v].querySelector('input[type="number"]');u=t?t.value:"1"}if(m[f]){const t=m[f].querySelector(".woocommerce-Price-amount");t&&(p=t.textContent.replace("£","").trim())}const _=o.querySelector(".add_to_cart_button"),g=_?_.href:"",w={id:h,name:y,url:n,image:{url:s,alt:a},video:{id:l,hasVideo:!!l},attributes:d,price:p,quantity:u,addToCartUrl:g};e.push(w)}),console.log("Extracted products:",e),e}(),o=function(e){const o={};t.columns.forEach(t=>{o[t]={}}),e.forEach(e=>{const r=e.attributes;t.columns.forEach(t=>{r[t]&&(o[t][r[t]]=(o[t][r[t]]||0)+1)})});const r={};return t.columns.forEach(t=>{r[t]=Object.keys(o[t]).map(e=>({value:e,text:e,count:o[t][e]}))}),r.totalCount=e.length,console.log("Extracted filters:",r),r}(e),s='<div class="mobile-layout">\x3c!-- Table-Style Filter --\x3e'+function(e){return'<div class="filter-table-wrapper"><div class="filter-table-header">'+t.headers.map((t,e)=>'<div class="filter-col">'+t+' <span class="sort_category"><i class="fa fa-sort" aria-hidden="true"></i></span></div>').join("")+'</div><div class="filter-table-controls">'+t.columns.map((t,o)=>{const r=e[t];return'<div class="filter-col"><select class="filter-select" data-filter-type="'+t+'">'+(r&&0!==r.length?'<option value="">Filter</option>'+r.map(t=>'<option value="'+t.value+'">'+t.text+"</option>").join(""):'<option value="">Filter</option>')+"</select></div>"}).join("")+"</div></div>"}(o)+'\x3c!-- Product Cards --\x3e<div class="product-cards">'+r(e)+"</div></div>";return{html:s,products:e,filters:o}}function a(e,o){let s=[...o],a={column:null,direction:"asc"};function c(t,e,o){return t.sort((t,r)=>{let s=t.attributes[e]||"",a=r.attributes[e]||"";const i=parseFloat(s),n=parseFloat(a);return isNaN(i)||isNaN(n)?"asc"===o?s.localeCompare(a):a.localeCompare(s):"asc"===o?i-n:n-i})}function l(o,r){if(e.querySelectorAll(".sort_category i").forEach(t=>{t.className="fa fa-sort"}),o){const s=t.columns.indexOf(o);if(-1!==s){const t=e.querySelectorAll(".sort_category i")[s];t&&(t.className="asc"===r?"fa fa-sort-up":"fa fa-sort-down")}}}function d(){const r=function(){const o={};return t.columns.forEach(t=>{o[t]=[]}),e.querySelectorAll(".filter-select").forEach(t=>{const e=t.getAttribute("data-filter-type"),r=t.value;r&&o[e]&&o[e].push(r)}),o}();s=o.filter(e=>{const o=e.attributes;return t.columns.every(t=>{const e=r[t];return 0===e.length||e.includes(o[t])})}),a.column&&(s=c(s,a.column,a.direction)),u(),p()}function u(){const t=s.length,o=e.querySelector("#results-count");o&&(o.textContent=t)}function p(){const t=e.querySelector(".product-cards");t&&(t.innerHTML=r(s),i(e),n(e))}e.querySelectorAll(".filter-select").forEach(t=>{t.value&&t.classList.add("selected"),t.addEventListener("change",function(){this.value?this.classList.add("selected"):this.classList.remove("selected"),d()})});const h=e.querySelector(".clear-filters-btn");h&&h.addEventListener("click",function(){e.querySelectorAll(".filter-select").forEach(t=>{t.value=""}),a={column:null,direction:"asc"},s=[...o],l(null,"asc"),u(),p()}),e.querySelectorAll(".filter-table-header .sort_category").forEach((e,o)=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const r=t.columns[o];a.column===r?a.direction="asc"===a.direction?"desc":"asc":(a.column=r,a.direction="asc"),s=c(s,a.column,a.direction),l(a.column,a.direction),p()})}),u()}function i(t){t.querySelectorAll(".qty-btn").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const o=this.getAttribute("data-product-id"),r=t.querySelector('input.quantity-input[data-product-id="'+o+'"]'),s=this.classList.contains("qty-plus"),a=this.classList.contains("qty-minus");if(r){let t=parseInt(r.value)||1;s?t++:a&&t>1&&t--,r.value=t,r.dispatchEvent(new Event("change",{bubbles:!0}))}})}),t.querySelectorAll(".quantity-input").forEach(t=>{t.addEventListener("click",function(t){t.stopPropagation()}),t.addEventListener("focus",function(t){t.stopPropagation()}),t.addEventListener("change",function(t){t.stopPropagation(),parseInt(this.value)<1&&(this.value=1)})})}function n(t){t.querySelectorAll(".add-to-cart-btn").forEach(e=>{e.addEventListener("click",function(){const e=this.getAttribute("data-product-id"),r=this.getAttribute("data-product-name"),s=t.querySelector('input.quantity-input[data-product-id="'+e+'"]'),a=s?s.value:1;void 0!==window.jQuery&&jQuery(".ATC").length>0&&(jQuery(".ATC-background").removeClass("ATC-background--dark"),jQuery(".ATC-loading").show(),jQuery(".ATC-popup").removeClass("slideUp"),jQuery(".ATC").show()),this.disabled=!0,this.textContent="Adding...";const i=new FormData;i.append("action","woocommerce_add_to_cart"),i.append("product_id",e),i.append("quantity",a);const n="undefined"!=typeof wc_add_to_cart_params?wc_add_to_cart_params.ajax_url:"/wp-admin/admin-ajax.php";fetch(n,{method:"POST",body:i}).then(t=>t.json()).then(t=>{t.error?(void 0!==window.jQuery&&jQuery(".ATC").length>0&&(jQuery(".ATC-loading").hide(),jQuery(".ATC").hide()),alert("Error adding to cart: "+t.error),this.textContent="Add to cart",this.disabled=!1):(void 0!==window.jQuery&&jQuery(".ATC").length>0&&(jQuery(".ATC-loading").hide(),jQuery(".ATC-background").addClass("ATC-background--dark"),jQuery(".ATC-popup").addClass("slideUp"),r&&jQuery(".ATC-popup__product h2").html(r+" has been added to cart!"),console.log("[DEBUG] About to check for getCrossSells. Product ID:",e),console.log("[DEBUG] typeof getCrossSells:",typeof o),console.log("[DEBUG] typeof window.getCrossSells:",typeof window.getCrossSells),console.log("[DEBUG] Calling getCrossSells(productId)"),o(e)),this.textContent="Added!",setTimeout(()=>{this.textContent="Add to cart",this.disabled=!1},2e3),"undefined"!=typeof jQuery&&jQuery("body").trigger("added_to_cart",[t.fragments,t.cart_hash,jQuery(this)]))}).catch(t=>{console.error("Add to cart error:",t),void 0!==window.jQuery&&jQuery(".ATC").length>0&&(jQuery(".ATC-loading").hide(),jQuery(".ATC").hide()),this.textContent="Error",setTimeout(()=>{this.textContent="Add to cart",this.disabled=!1},2e3)})})})}e.textContent=".mobile-layout { display: block !important; } .which-mesh-category { display: none !important; } .mobile-scroll { display: none !important; } .table-wrapper1 { display: none !important; } ",document.head.appendChild(e);try{const t=function(){const t=s();if(0===t.products.length)return void console.error("No products found in table");const e=document.createElement("div");e.innerHTML=t.html;const o=document.querySelector(".which-mesh-category");if(o){o.parentNode.insertBefore(e,o.nextSibling),o.style.display="none",e.querySelector(".mobile-layout").style.display="block";const r=document.createElement("style");r.textContent="@media (min-width: 1025px) { .mobile-layout { display: none !important; } .which-mesh-category { display: table !important; } } ",document.head.appendChild(r),a(e,t.products),i(e),n(e)}return t}();console.log("VWO Mobile Layout Test: Success",t)}catch(t){console.error("VWO Mobile Layout Test Error:",t)}})}();